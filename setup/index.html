
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A full featured walkthough of using Django on Zappa (powered by AWS Lambda in serverless environment)">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.6">
    
    
      
        <title>Setup your Environment - Guide to using Django with Zappa</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.875de78c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-97437653-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#setup-your-environment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-announce">
          <div class="md-announce__inner md-grid md-typeset">
            
Now Available! Complete video tutorials with my new course: <a
    href="https://www.newline.co/courses/serverless-django-with-zappa/" style="color: #0ee7ff">Newline's Serverless
    Django with Zappa</a>

          </div>
        </aside>
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Guide to using Django with Zappa" class="md-header__button md-logo" aria-label="Guide to using Django with Zappa" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Guide to using Django with Zappa
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Setup your Environment
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/edgarroman/zappa-django-guide/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    edgarroman/zappa-django-guide
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Guide to using Django with Zappa" class="md-nav__button md-logo" aria-label="Guide to using Django with Zappa" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Guide to using Django with Zappa
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/edgarroman/zappa-django-guide/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    edgarroman/zappa-django-guide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Walkthroughs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Walkthroughs" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Walkthroughs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Setup your Environment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Setup your Environment
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-do-i-need-a-working-environment" class="md-nav__link">
    Why do I need a working environment?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#baseline-packages" class="md-nav__link">
    Baseline packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approach-1-local-machine" class="md-nav__link">
    Approach #1 - Local Machine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approach-2-docker-with-zappa-recommended" class="md-nav__link">
    Approach #2 - Docker with zappa (recommended)
  </a>
  
    <nav class="md-nav" aria-label="Approach #2 - Docker with zappa (recommended)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inital-setup" class="md-nav__link">
    Inital Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taking-a-test-drive" class="md-nav__link">
    Taking a test drive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-setup" class="md-nav__link">
    Project Setup
  </a>
  
    <nav class="md-nav" aria-label="Project Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-dockerfile" class="md-nav__link">
    Create a Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-the-docker-image" class="md-nav__link">
    Build the docker image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-your-zappashell-alias" class="md-nav__link">
    Update your zappashell alias
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-virtual-environment" class="md-nav__link">
    Create the Virtual Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-your-environment" class="md-nav__link">
    Using your environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../walk_core/" class="md-nav__link">
        Core Django Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../walk_static/" class="md-nav__link">
        Hosting Static Files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../walk_database/" class="md-nav__link">
        Using a Database
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../walk_domain/" class="md-nav__link">
        Custom Domains
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../walk_app/" class="md-nav__link">
        Application Adaptations
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        AWS Setup
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="AWS Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          AWS Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws_credentials/" class="md-nav__link">
        Managing Credentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws_network_primer/" class="md-nav__link">
        Primer on AWS VPC Networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws_network/" class="md-nav__link">
        Adventures in Networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws_database/" class="md-nav__link">
        Creating an RDS Database
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws_route53/" class="md-nav__link">
        Working with Route53
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws_acm/" class="md-nav__link">
        AWS Certificate Manager (ACM)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../additional/" class="md-nav__link">
        Additional
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-do-i-need-a-working-environment" class="md-nav__link">
    Why do I need a working environment?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#baseline-packages" class="md-nav__link">
    Baseline packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approach-1-local-machine" class="md-nav__link">
    Approach #1 - Local Machine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approach-2-docker-with-zappa-recommended" class="md-nav__link">
    Approach #2 - Docker with zappa (recommended)
  </a>
  
    <nav class="md-nav" aria-label="Approach #2 - Docker with zappa (recommended)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inital-setup" class="md-nav__link">
    Inital Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taking-a-test-drive" class="md-nav__link">
    Taking a test drive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-setup" class="md-nav__link">
    Project Setup
  </a>
  
    <nav class="md-nav" aria-label="Project Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-dockerfile" class="md-nav__link">
    Create a Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-the-docker-image" class="md-nav__link">
    Build the docker image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-your-zappashell-alias" class="md-nav__link">
    Update your zappashell alias
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-virtual-environment" class="md-nav__link">
    Create the Virtual Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-your-environment" class="md-nav__link">
    Using your environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/edgarroman/zappa-django-guide/edit/master/docs/setup.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="setup-your-environment">Setup your Environment<a class="headerlink" href="#setup-your-environment" title="Permanent link">&para;</a></h1>
<p>This section provides guidance to set up a zappa working environment.</p>
<h2 id="why-do-i-need-a-working-environment">Why do I need a working environment?<a class="headerlink" href="#why-do-i-need-a-working-environment" title="Permanent link">&para;</a></h2>
<p>While the ultimate goal is to have your Django application hosted in a cloud-based serverless environment, a working environment is needed to:</p>
<ul>
<li>Collect the required packages</li>
<li>Build a lambda compatible deployment</li>
<li>Upload the deployment</li>
<li>Coordinate the various AWS services to enable the cloud-based environment</li>
</ul>
<p>In addition, a working environment assists with development and testing. The caveat is that this working environment will not match exactly the cloud-based deployment. However, the goal is to get a reasonablly close approximation while still balancing ease of use.</p>
<h2 id="baseline-packages">Baseline packages<a class="headerlink" href="#baseline-packages" title="Permanent link">&para;</a></h2>
<p>To ensure baseline expectations are set, all environments will assume the following criteria:</p>
<ul>
<li>Python 3 (according to <a href="http://docs.aws.amazon.com/lambda/latest/dg/current-supported-versions.html">AWS lambda support</a>)</li>
<li>Django 3.2 or newer</li>
<li>Latest version of <a href="https://pypi.python.org/pypi/zappa">zappa</a></li>
</ul>
<p>In addition, zappa <em>requires</em> a virtual environment in which to function. So all approaches below include a virtual environment.</p>
<h2 id="approach-1-local-machine">Approach #1 - Local Machine<a class="headerlink" href="#approach-1-local-machine" title="Permanent link">&para;</a></h2>
<p>You can easily set up your working environment on your local machine. For simple projects, this is very easy to manage and maintain. All you need is Python 3, pip, and virtualenv installed. This works for Windows, MacOS, and Linux machines.</p>
<p>Here we setup a working environment named 'zappatest'</p>
<div class="highlight"><pre><span></span><code>mkdir zappatest
<span class="nb">cd</span> zappatest
virtualenv ve
<span class="nb">source</span> ve/bin/activate
pip install django zappa
</code></pre></div>
<p>And you are done.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While this approach is easy to get up and running, the challenge comes along when you require more advanced python packages.</p>
<p>For example, once you start connecting to databases, you will need to compile packages such as 'psycopg2' for PostGresSQL.  You should consider the implications of installing needed libraries on your local machine.</p>
<p>This is approach is not recommended for any type of serious zappa effort.</p>
</div>
<h2 id="approach-2-docker-with-zappa-recommended">Approach #2 - Docker with zappa (recommended)<a class="headerlink" href="#approach-2-docker-with-zappa-recommended" title="Permanent link">&para;</a></h2>
<p>Sometimes leveraging Docker to create an isolated working environment is a good idea. It takes more work to setup initially, but once you have the foundations, it is quite easy to create multiple working environments and it is easier to share those same environments with other folks on your team.</p>
<p>The main goal of using Docker is to create an environment that closely matches the AWS lambda environment. The closer it matches, then there will be less difficult-to-debug problems.</p>
<p>We will leverage the work others have done to enable such an environment. First and foremost, the folks from <a href="https://github.com/lambci/lambci">lambci</a> have created github repo called <a href="https://github.com/lambci/docker-lambda">docker-lambda</a> that accurately reflects the lambda environment. It provides:</p>
<ul>
<li>Multiple uses<ul>
<li>A 'build' image for compilation, package creation, and deployment</li>
<li>A 'run' image for testing and execution of your code</li>
</ul>
</li>
</ul>
<p>For the purposes of this walkthrough we will focus only on the 'build' image that provides a very nice interactive working environment for zappa. Further research into how to use the 'run' image is left as an exercise for the reader.</p>
<ul>
<li>Multiple Python version support<ul>
<li>Python 3.8 (<a href="https://hub.docker.com/r/lambci/lambda/tags/">lambci/lambda:build-python3.8</a>)</li>
</ul>
</li>
</ul>
<p>Note that this work was originally inspired from <a href="https://github.com/danielwhatmuff/zappa">danielwhatmuff/zappa</a> but has been enhanced to illustrate support for Python 3</p>
<h3 id="inital-setup">Inital Setup<a class="headerlink" href="#inital-setup" title="Permanent link">&para;</a></h3>
<p>These steps need to be performed once for a new system</p>
<ul>
<li><a href="https://docs.docker.com/engine/installation/">Install Docker</a></li>
<li>
<p>Pull the zappa docker image from Docker github</p>
<div class="highlight"><pre><span></span><code><span class="c1"># For Python 3.6 projects</span>
docker pull lambci/lambda:build-python3.8
</code></pre></div>
</li>
<li>
<p>Create a shortcut that allows AWS credentials to pass through to the docker container</p>
<ul>
<li>If you use <a href="aws_credentials#setup-local-account-credentials">environment variables for AWS Credentials</a> then use:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">alias</span> <span class="nv">zappashell</span><span class="o">=</span><span class="s1">&#39;docker run -ti -e AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY -e AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID -e AWS_DEFAULT_REGION=$AWS_DEFAULT_REGION -v &quot;$(pwd):/var/task&quot;  --rm lambci/lambda:build-python3.6 bash&#39;</span>
<span class="nb">alias</span> zappashell &gt;&gt; ~/.bash_profile
</code></pre></div>
<p>Be sure to define the <code>$AWS_DEFAULT_REGION</code> environment variable</p>
<ul>
<li>If you use a <a href="aws_credentials#setup-local-account-credentials">credentials file for AWS Credentials</a> then use:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">alias</span> <span class="nv">zappashell</span><span class="o">=</span><span class="s1">&#39;docker run -ti -e AWS_PROFILE=$AWS_PROFILE -v &quot;$(pwd):/var/task&quot; -v ~/.aws/:/root/.aws  --rm lambci/lambda:build-python3.6 bash&#39;</span>
<span class="nb">alias</span> zappashell &gt;&gt; ~/.bash_profile
</code></pre></div>
<p>Note that you must either define the <code>$AWS_PROFILE</code> environment variable or edit the alias above to be hardcoded to a specific profile. Example of hardcoding the alias:</p>
<div class="highlight"><pre><span></span><code><span class="nb">alias</span> <span class="nv">zappashell</span><span class="o">=</span><span class="s1">&#39;docker run -ti -e AWS_PROFILE=zappa -v &quot;$(pwd):/var/task&quot; -v ~/.aws/:/root/.aws  --rm lambci/lambda:build-python3.6 bash&#39;</span>
</code></pre></div>
</li>
</ul>
<h3 id="taking-a-test-drive">Taking a test drive<a class="headerlink" href="#taking-a-test-drive" title="Permanent link">&para;</a></h3>
<p>So let's try this out now. Examples going forward will focus on Python 3.6. To fire up the docker container use:</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">cd</span> /your_zappa_project
$ zappashell
bash-4.2#
</code></pre></div>
<p>Next, create the <em>required</em> virtual environment, activate it, and install needed dependencies</p>
<div class="highlight"><pre><span></span><code>bash-4.2# virtualenv ve
bash-4.2# <span class="nb">source</span> ve/bin/activate
<span class="o">(</span>ve<span class="o">)</span> bash-4.2# pip install -r requirements.txt
</code></pre></div>
<p>Since the virtual environment is contained in the current directory, and the current directory is mapped to your local machine, any changes you make will be persisted between Docker container instances. But if you depend on libraries that are installed in the system (essentially anything out of the current directory and virtual environment), they will be lost when the container exits. The solution for this is to create a custom Dockerfile (see below)</p>
<p>Finally, I recommend upgrading to the latest zappa project since it changes frequently</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>ve<span class="o">)</span> bash-4.2# pip install --upgrade zappa
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is very important that you install and activate the virtualenv only in the docker shell. This will prevent any incompatibilities with the local system environment and the docker environment.</p>
</div>
<p>At this point, you are ready to start using zappa. Once you are finished, you can simply exit the container.</p>
<h3 id="project-setup">Project Setup<a class="headerlink" href="#project-setup" title="Permanent link">&para;</a></h3>
<p>Once the steps above are complete, then it is very easy to start a working environment. But generally additional steps are required for package compilation and customizations.</p>
<h4 id="create-a-dockerfile">Create a Dockerfile<a class="headerlink" href="#create-a-dockerfile" title="Permanent link">&para;</a></h4>
<p>Create a local Dockerfile for your project so you can easily modify needed libraries. Generally this can go in the root of your zappa project.</p>
<div class="highlight"><pre><span></span><code><span class="k">FROM</span> <span class="s">lambci/lambda:build-python3.6</span>

<span class="k">LABEL</span> <span class="nv">maintainer</span><span class="o">=</span><span class="s2">&quot;&lt;your@email.com&gt;&quot;</span>

<span class="k">WORKDIR</span><span class="s"> /var/task</span>

<span class="c"># Fancy prompt to remind you are in zappashell</span>
<span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;export PS1=&quot;\[\e[36m\]zappashell&gt;\[\e[m\] &quot;&#39;</span> &gt;&gt; /root/.bashrc

<span class="c"># Additional RUN commands here</span>
<span class="c"># RUN yum clean all &amp;&amp; \</span>
<span class="c">#    yum -y install &lt;stuff&gt;</span>

<span class="k">CMD</span> <span class="p">[</span><span class="s2">&quot;bash&quot;</span><span class="p">]</span>
</code></pre></div>
<h4 id="build-the-docker-image">Build the docker image<a class="headerlink" href="#build-the-docker-image" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>$ <span class="nb">cd</span> /your_zappa_project
$ docker build -t myzappa .
</code></pre></div>
<p>This will create a local Docker image on your system.</p>
<h4 id="update-your-zappashell-alias">Update your zappashell alias<a class="headerlink" href="#update-your-zappashell-alias" title="Permanent link">&para;</a></h4>
<p>To make sure it points to your new image. Essentially replace <code>lambci/lambda:build-python3.6</code> with <code>myzappa</code>. Example:</p>
<div class="highlight"><pre><span></span><code><span class="nb">alias</span> <span class="nv">zappashell</span><span class="o">=</span><span class="s1">&#39;docker run -ti -e AWS_PROFILE=zappa -v &quot;$(pwd):/var/task&quot; -v ~/.aws/:/root/.aws  --rm myzappa&#39;</span>
<span class="nb">alias</span> zappashell &gt;&gt; ~/.bash_profile
</code></pre></div>
<h4 id="create-the-virtual-environment">Create the Virtual Environment<a class="headerlink" href="#create-the-virtual-environment" title="Permanent link">&para;</a></h4>
<p>Create the <em>required</em> virtual environment, activate it, and install needed dependencies</p>
<div class="highlight"><pre><span></span><code>$ zappashell
zappashell&gt; python -m venv ve
zappashell&gt; <span class="nb">source</span> ve/bin/activate
<span class="o">(</span>ve<span class="o">)</span> zappa&gt; pip install -r requirements.txt
</code></pre></div>
<p>Since the virtual environment is contained in the current directory, and the current directory is mapped to your local machine, any changes you make will be persisted between Docker container instances. But if you depend on libraries that are installed in the system (essentially anything out of the current directory and virtual environment), they will be lost when the container exits. The solution for this is to add these installations as RUN commands in the Dockerfile.</p>
<h3 id="using-your-environment">Using your environment<a class="headerlink" href="#using-your-environment" title="Permanent link">&para;</a></h3>
<p>Each time you are working on your project, merely fire up the container:</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">cd</span> /your_zappa_project
$ zappashell
zappashell&gt; <span class="nb">source</span> ve/bin/activate
<span class="o">(</span>ve<span class="o">)</span> zappashell&gt;
</code></pre></div>
<p>All zappa commands can be used to deploy your project:</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>ve<span class="o">)</span> zappashell&gt; zappa status dev
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href=".." class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Home
            </div>
          </div>
        </a>
      
      
        <a href="../walk_core/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Core Django Setup
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; <script>document.write(new Date().getFullYear())</script> <a href="https://github.com/edgarroman">Edgar Roman</a>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/edgarroman" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.34eae1b6.min.js"></script>
      
    
  </body>
</html>